<!DOCTYPE html>
<html>
  <head>
    <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
    <script src="https://unpkg.com/aframe-environment-component@1.3.3/dist/aframe-environment-component.min.js"></script>
    <script>
      AFRAME.registerComponent('eater', {
        init: function () {
          this.el.addEventListener('click', function (evt) {
            this.remove();
          });
        }
      });

      AFRAME.registerComponent('city-generator', {
        init: function () {
          const scene = this.el.sceneEl;
          
          for (let i = 0; i < 50; i++) {
            let box = document.createElement('a-box');
            let x = (Math.random() * 200) - 100;
            let z = (Math.random() * 200) - 100;
            let h = (Math.random() * 20) + 10;
            
            box.setAttribute('position', {x: x, y: h/2, z: z});
            box.setAttribute('width', 10);
            box.setAttribute('depth', 10);
            box.setAttribute('height', h);
            box.setAttribute('color', '#555');
            scene.appendChild(box);
          }

          for (let i = 0; i < 50; i++) {
            let person = document.createElement('a-cylinder');
            let x = (Math.random() * 100) - 50;
            let z = (Math.random() * 100) - 50;
            
            person.setAttribute('position', {x: x, y: 1, z: z});
            person.setAttribute('height', 2);
            person.setAttribute('radius', 0.8);
            person.setAttribute('color', 'red');
            person.setAttribute('eater', '');
            
            let anim = document.createElement('a-animation');
            person.setAttribute('animation', {
              property: 'position',
              to: {x: x + (Math.random() * 10 - 5), y: 1, z: z + (Math.random() * 10 - 5)},
              dir: 'alternate',
              dur: 2000,
              loop: true
            });
            
            scene.appendChild(person);
          }
        }
      });
    </script>
  </head>
  <body>
    <a-scene city-generator cursor="rayOrigin: mouse">
      <a-entity environment="preset: tron; skyType: atmosphere; lighting: point"></a-entity>
      
      <a-entity position="0 40 0" rotation="-45 0 0">
        <a-camera wasd-controls-enabled="true" look-controls-enabled="true">
        </a-camera>
      </a-entity>

    </a-scene>
  </body>
</html>
